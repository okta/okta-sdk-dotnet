/*
 * Okta API
 *
 * Allows customers to easily access the Okta API
 *
 * The version of the OpenAPI document: 5.1.0
 * Contact: devex-public@okta.com
 * Generated by: https://github.com/openapitools/openapi-generator.git
 */

using System.Net;
using System.Threading.Tasks;
using FluentAssertions;
using Okta.Sdk.Api;
using Okta.Sdk.Client;
using Okta.Sdk.Model;
using Okta.Sdk.UnitTest.Internal;
using Xunit;

namespace Okta.Sdk.UnitTest.Api
{
    /// <summary>
    ///  Class for testing UserApi
    /// </summary>
    public class UserApiTests
    {
        #region CreateUser Tests

        [Fact]
        public async Task CreateUser_WithMinimalProfile_ReturnsUser()
        {
            // Arrange
            var userId = "user-123";
            var firstName = "John";
            var lastName = "Doe";
            var email = "john.doe@example.com";
            var login = "john.doe@example.com";

            var responseJson = @"{
                ""id"": """ + userId + @""",
                ""status"": ""STAGED"",
                ""created"": ""2025-10-05T12:00:00.000Z"",
                ""activated"": null,
                ""statusChanged"": ""2025-10-05T12:00:00.000Z"",
                ""lastLogin"": null,
                ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                ""passwordChanged"": null,
                ""profile"": {
                    ""firstName"": """ + firstName + @""",
                    ""lastName"": """ + lastName + @""",
                    ""email"": """ + email + @""",
                    ""login"": """ + login + @"""
                },
                ""credentials"": {
                    ""provider"": {
                        ""type"": ""OKTA"",
                        ""name"": ""OKTA""
                    }
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            var request = new CreateUserRequest
            {
                Profile = new UserProfile
                {
                    FirstName = firstName,
                    LastName = lastName,
                    Email = email,
                    Login = login
                }
            };

            // Act
            var user = await userApi.CreateUserAsync(request, activate: false);

            // Assert
            user.Should().NotBeNull();
            user.Id.Should().Be(userId);
            user.Status.Should().Be(UserStatus.STAGED);
            user.Profile.Should().NotBeNull();
            user.Profile.FirstName.Should().Be(firstName);
            user.Profile.LastName.Should().Be(lastName);
            user.Profile.Email.Should().Be(email);
            user.Profile.Login.Should().Be(login);

            mockClient.ReceivedPath.Should().Be("/api/v1/users");
            mockClient.ReceivedBody.Should().Contain(firstName);
            mockClient.ReceivedBody.Should().Contain(lastName);
            mockClient.ReceivedBody.Should().Contain(email);
        }

        [Fact]
        public async Task CreateUser_WithPassword_ReturnsActiveUser()
        {
            // Arrange
            var userId = "user-456";
            var password = "TestPassword123!";

            var responseJson = @"{
                ""id"": """ + userId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-05T12:00:00.000Z"",
                ""activated"": ""2025-10-05T12:00:00.000Z"",
                ""statusChanged"": ""2025-10-05T12:00:00.000Z"",
                ""lastLogin"": null,
                ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                ""passwordChanged"": ""2025-10-05T12:00:00.000Z"",
                ""profile"": {
                    ""firstName"": ""Jane"",
                    ""lastName"": ""Smith"",
                    ""email"": ""jane.smith@example.com"",
                    ""login"": ""jane.smith@example.com""
                },
                ""credentials"": {
                    ""password"": {},
                    ""provider"": {
                        ""type"": ""OKTA"",
                        ""name"": ""OKTA""
                    }
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            var request = new CreateUserRequest
            {
                Profile = new UserProfile
                {
                    FirstName = "Jane",
                    LastName = "Smith",
                    Email = "jane.smith@example.com",
                    Login = "jane.smith@example.com"
                },
                Credentials = new UserCredentialsWritable
                {
                    Password = new PasswordCredential { Value = password }
                }
            };

            // Act
            var user = await userApi.CreateUserAsync(request, activate: true);

            // Assert
            user.Should().NotBeNull();
            user.Id.Should().Be(userId);
            user.Status.Should().Be(UserStatus.ACTIVE);
            user.Credentials.Should().NotBeNull();
            user.Credentials.Provider.Type.Should().Be(AuthenticationProviderType.OKTA);

            mockClient.ReceivedBody.Should().Contain("Jane");
            mockClient.ReceivedBody.Should().Contain("Smith");
        }

        [Fact]
        public async Task CreateUser_WithExtendedProfile_IncludesAllProperties()
        {
            // Arrange
            var responseJson = @"{
                ""id"": ""user-789"",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-05T12:00:00.000Z"",
                ""activated"": ""2025-10-05T12:00:00.000Z"",
                ""statusChanged"": ""2025-10-05T12:00:00.000Z"",
                ""lastLogin"": null,
                ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                ""passwordChanged"": ""2025-10-05T12:00:00.000Z"",
                ""profile"": {
                    ""firstName"": ""Alice"",
                    ""lastName"": ""Williams"",
                    ""email"": ""alice.williams@example.com"",
                    ""login"": ""alice.williams@example.com"",
                    ""mobilePhone"": ""555-123-4567"",
                    ""secondEmail"": ""alice.alt@example.com"",
                    ""city"": ""San Francisco"",
                    ""state"": ""CA"",
                    ""zipCode"": ""94102"",
                    ""countryCode"": ""US""
                },
                ""credentials"": {
                    ""password"": {},
                    ""provider"": {
                        ""type"": ""OKTA"",
                        ""name"": ""OKTA""
                    }
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/user-789""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            var request = new CreateUserRequest
            {
                Profile = new UserProfile
                {
                    FirstName = "Alice",
                    LastName = "Williams",
                    Email = "alice.williams@example.com",
                    Login = "alice.williams@example.com",
                    MobilePhone = "555-123-4567",
                    SecondEmail = "alice.alt@example.com",
                    City = "San Francisco",
                    State = "CA",
                    ZipCode = "94102",
                    CountryCode = "US"
                },
                Credentials = new UserCredentialsWritable
                {
                    Password = new PasswordCredential { Value = "Password123!" }
                }
            };

            // Act
            var user = await userApi.CreateUserAsync(request, activate: true);

            // Assert
            user.Should().NotBeNull();
            user.Profile.MobilePhone.Should().Be("555-123-4567");
            user.Profile.City.Should().Be("San Francisco");
            user.Profile.State.Should().Be("CA");
            user.Profile.ZipCode.Should().Be("94102");

            mockClient.ReceivedBody.Should().Contain("San Francisco");
            mockClient.ReceivedBody.Should().Contain("555-123-4567");
        }

        [Fact]
        public async Task CreateUser_CallsCorrectEndpoint()
        {
            // Arrange
            var responseJson = @"{
                ""id"": ""user-123"",
                ""status"": ""STAGED"",
                ""created"": ""2025-10-05T12:00:00.000Z"",
                ""activated"": null,
                ""statusChanged"": ""2025-10-05T12:00:00.000Z"",
                ""lastLogin"": null,
                ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                ""passwordChanged"": null,
                ""profile"": {
                    ""firstName"": ""Test"",
                    ""lastName"": ""User"",
                    ""email"": ""test@example.com"",
                    ""login"": ""test@example.com""
                },
                ""credentials"": {
                    ""provider"": {
                        ""type"": ""OKTA"",
                        ""name"": ""OKTA""
                    }
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/user-123""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            var request = new CreateUserRequest
            {
                Profile = new UserProfile
                {
                    FirstName = "Test",
                    LastName = "User",
                    Email = "test@example.com",
                    Login = "test@example.com"
                }
            };

            // Act
            await userApi.CreateUserAsync(request, activate: false);

            // Assert
            mockClient.ReceivedPath.Should().Be("/api/v1/users");
        }

        #endregion

        #region GetUser Tests

        [Fact]
        public async Task GetUser_ById_ReturnsCorrectUser()
        {
            // Arrange
            var userId = "user-get-123";
            var email = "get.user@example.com";

            var responseJson = @"{
                ""id"": """ + userId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-05T12:00:00.000Z"",
                ""activated"": ""2025-10-05T12:00:00.000Z"",
                ""statusChanged"": ""2025-10-05T12:00:00.000Z"",
                ""lastLogin"": ""2025-10-06T08:00:00.000Z"",
                ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                ""passwordChanged"": ""2025-10-05T12:00:00.000Z"",
                ""profile"": {
                    ""firstName"": ""Get"",
                    ""lastName"": ""User"",
                    ""email"": """ + email + @""",
                    ""login"": """ + email + @"""
                },
                ""credentials"": {
                    ""password"": {},
                    ""provider"": {
                        ""type"": ""OKTA"",
                        ""name"": ""OKTA""
                    }
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var user = await userApi.GetUserAsync(userId);

            // Assert
            user.Should().NotBeNull();
            user.Id.Should().Be(userId);
            user.Status.Should().Be(UserStatus.ACTIVE);
            user.Profile.Email.Should().Be(email);

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{id}");
            mockClient.ReceivedPathParams.Should().ContainKey("id");
            mockClient.ReceivedPathParams["id"].Should().Contain(userId);
        }

        [Fact]
        public async Task GetUser_ByLogin_CallsCorrectEndpoint()
        {
            // Arrange
            var login = "test.user@example.com";

            var responseJson = @"{
                ""id"": ""user-login-123"",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-05T12:00:00.000Z"",
                ""activated"": ""2025-10-05T12:00:00.000Z"",
                ""statusChanged"": ""2025-10-05T12:00:00.000Z"",
                ""lastLogin"": null,
                ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                ""passwordChanged"": ""2025-10-05T12:00:00.000Z"",
                ""profile"": {
                    ""firstName"": ""Test"",
                    ""lastName"": ""User"",
                    ""email"": """ + login + @""",
                    ""login"": """ + login + @"""
                },
                ""credentials"": {
                    ""password"": {},
                    ""provider"": {
                        ""type"": ""OKTA"",
                        ""name"": ""OKTA""
                    }
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/user-login-123""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var user = await userApi.GetUserAsync(login);

            // Assert
            user.Should().NotBeNull();
            user.Profile.Login.Should().Be(login);

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{id}");
            mockClient.ReceivedPathParams.Should().ContainKey("id");
            mockClient.ReceivedPathParams["id"].Should().Contain(login);
        }

        [Fact]
        public async Task GetUser_WithDifferentStatuses_ReturnsCorrectStatus()
        {
            // Arrange
            var userId = "user-suspended-123";

            var responseJson = @"{
                ""id"": """ + userId + @""",
                ""status"": ""SUSPENDED"",
                ""created"": ""2025-10-05T12:00:00.000Z"",
                ""activated"": ""2025-10-05T12:00:00.000Z"",
                ""statusChanged"": ""2025-10-06T12:00:00.000Z"",
                ""lastLogin"": ""2025-10-05T15:00:00.000Z"",
                ""lastUpdated"": ""2025-10-06T12:00:00.000Z"",
                ""passwordChanged"": ""2025-10-05T12:00:00.000Z"",
                ""profile"": {
                    ""firstName"": ""Suspended"",
                    ""lastName"": ""User"",
                    ""email"": ""suspended@example.com"",
                    ""login"": ""suspended@example.com""
                },
                ""credentials"": {
                    ""password"": {},
                    ""provider"": {
                        ""type"": ""OKTA"",
                        ""name"": ""OKTA""
                    }
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var user = await userApi.GetUserAsync(userId);

            // Assert
            user.Should().NotBeNull();
            user.Status.Should().Be(UserStatus.SUSPENDED);
        }

        #endregion

        #region UpdateUser Tests

        [Fact]
        public async Task UpdateUser_PartialUpdate_ReturnsUpdatedUser()
        {
            // Arrange
            var userId = "user-update-123";
            var newMobilePhone = "555-999-8888";
            var newCity = "New York";

            var responseJson = @"{
                ""id"": """ + userId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-05T12:00:00.000Z"",
                ""activated"": ""2025-10-05T12:00:00.000Z"",
                ""statusChanged"": ""2025-10-05T12:00:00.000Z"",
                ""lastLogin"": null,
                ""lastUpdated"": ""2025-10-06T12:00:00.000Z"",
                ""passwordChanged"": ""2025-10-05T12:00:00.000Z"",
                ""profile"": {
                    ""firstName"": ""Update"",
                    ""lastName"": ""Test"",
                    ""email"": ""update@example.com"",
                    ""login"": ""update@example.com"",
                    ""mobilePhone"": """ + newMobilePhone + @""",
                    ""city"": """ + newCity + @"""
                },
                ""credentials"": {
                    ""password"": {},
                    ""provider"": {
                        ""type"": ""OKTA"",
                        ""name"": ""OKTA""
                    }
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            var updateRequest = new UpdateUserRequest
            {
                Profile = new UserProfile
                {
                    MobilePhone = newMobilePhone,
                    City = newCity
                }
            };

            // Act
            var user = await userApi.UpdateUserAsync(userId, updateRequest);

            // Assert
            user.Should().NotBeNull();
            user.Id.Should().Be(userId);
            user.Profile.MobilePhone.Should().Be(newMobilePhone);
            user.Profile.City.Should().Be(newCity);

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{id}");
            mockClient.ReceivedPathParams.Should().ContainKey("id");
            mockClient.ReceivedPathParams["id"].Should().Contain(userId);
            mockClient.ReceivedBody.Should().Contain(newMobilePhone);
            mockClient.ReceivedBody.Should().Contain(newCity);
        }

        [Fact]
        public async Task UpdateUser_CallsCorrectEndpoint()
        {
            // Arrange
            var userId = "user-update-456";

            var responseJson = @"{
                ""id"": """ + userId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-05T12:00:00.000Z"",
                ""activated"": ""2025-10-05T12:00:00.000Z"",
                ""statusChanged"": ""2025-10-05T12:00:00.000Z"",
                ""lastLogin"": null,
                ""lastUpdated"": ""2025-10-06T12:00:00.000Z"",
                ""passwordChanged"": ""2025-10-05T12:00:00.000Z"",
                ""profile"": {
                    ""firstName"": ""Updated"",
                    ""lastName"": ""User"",
                    ""email"": ""updated@example.com"",
                    ""login"": ""updated@example.com""
                },
                ""credentials"": {
                    ""password"": {},
                    ""provider"": {
                        ""type"": ""OKTA"",
                        ""name"": ""OKTA""
                    }
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            var updateRequest = new UpdateUserRequest
            {
                Profile = new UserProfile
                {
                    FirstName = "Updated"
                }
            };

            // Act
            await userApi.UpdateUserAsync(userId, updateRequest);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{id}");
            mockClient.ReceivedPathParams.Should().ContainKey("id");
            mockClient.ReceivedPathParams["id"].Should().Contain(userId);
        }

        #endregion

        #region ReplaceUser Tests

        [Fact]
        public async Task ReplaceUser_FullUpdate_ReturnsReplacedUser()
        {
            // Arrange
            var userId = "user-replace-123";
            var newFirstName = "NewFirstName";
            var newLastName = "NewLastName";

            var responseJson = @"{
                ""id"": """ + userId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-05T12:00:00.000Z"",
                ""activated"": ""2025-10-05T12:00:00.000Z"",
                ""statusChanged"": ""2025-10-05T12:00:00.000Z"",
                ""lastLogin"": null,
                ""lastUpdated"": ""2025-10-06T13:00:00.000Z"",
                ""passwordChanged"": ""2025-10-05T12:00:00.000Z"",
                ""profile"": {
                    ""firstName"": """ + newFirstName + @""",
                    ""lastName"": """ + newLastName + @""",
                    ""email"": ""replace@example.com"",
                    ""login"": ""replace@example.com""
                },
                ""credentials"": {
                    ""password"": {},
                    ""provider"": {
                        ""type"": ""OKTA"",
                        ""name"": ""OKTA""
                    }
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            var replaceRequest = new UpdateUserRequest
            {
                Profile = new UserProfile
                {
                    FirstName = newFirstName,
                    LastName = newLastName,
                    Email = "replace@example.com",
                    Login = "replace@example.com"
                }
            };

            // Act
            var user = await userApi.ReplaceUserAsync(userId, replaceRequest);

            // Assert
            user.Should().NotBeNull();
            user.Profile.FirstName.Should().Be(newFirstName);
            user.Profile.LastName.Should().Be(newLastName);

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{id}");
            mockClient.ReceivedPathParams.Should().ContainKey("id");
            mockClient.ReceivedPathParams["id"].Should().Contain(userId);
            mockClient.ReceivedBody.Should().Contain(newFirstName);
            mockClient.ReceivedBody.Should().Contain(newLastName);
        }

        [Fact]
        public async Task ReplaceUser_CallsCorrectEndpoint()
        {
            // Arrange
            var userId = "user-replace-456";

            var responseJson = @"{
                ""id"": """ + userId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-05T12:00:00.000Z"",
                ""activated"": ""2025-10-05T12:00:00.000Z"",
                ""statusChanged"": ""2025-10-05T12:00:00.000Z"",
                ""lastLogin"": null,
                ""lastUpdated"": ""2025-10-06T13:00:00.000Z"",
                ""passwordChanged"": ""2025-10-05T12:00:00.000Z"",
                ""profile"": {
                    ""firstName"": ""Replaced"",
                    ""lastName"": ""User"",
                    ""email"": ""replaced@example.com"",
                    ""login"": ""replaced@example.com""
                },
                ""credentials"": {
                    ""password"": {},
                    ""provider"": {
                        ""type"": ""OKTA"",
                        ""name"": ""OKTA""
                    }
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            var replaceRequest = new UpdateUserRequest
            {
                Profile = new UserProfile
                {
                    FirstName = "Replaced",
                    LastName = "User",
                    Email = "replaced@example.com",
                    Login = "replaced@example.com"
                }
            };

            // Act
            await userApi.ReplaceUserAsync(userId, replaceRequest);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{id}");
            mockClient.ReceivedPathParams.Should().ContainKey("id");
            mockClient.ReceivedPathParams["id"].Should().Contain(userId);
        }

        #endregion

        #region DeleteUser Tests

        [Fact]
        public async Task DeleteUser_CallsCorrectEndpoint()
        {
            // Arrange
            var userId = "user-delete-123";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await userApi.DeleteUserAsync(userId, sendEmail: false);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{id}");
            mockClient.ReceivedPathParams.Should().ContainKey("id");
            mockClient.ReceivedPathParams["id"].Should().Contain(userId);
        }

        [Fact]
        public async Task DeleteUser_WithSendEmailTrue_IncludesQueryParameter()
        {
            // Arrange
            var userId = "user-delete-456";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await userApi.DeleteUserAsync(userId, sendEmail: true);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{id}");
            mockClient.ReceivedPathParams.Should().ContainKey("id");
            mockClient.ReceivedPathParams["id"].Should().Contain(userId);
            mockClient.ReceivedQueryParams.Should().NotBeNull();
        }

        #endregion

        #region ListUsers Tests

        [Fact]
        public async Task ListUsers_ReturnsUserList()
        {
            // Arrange
            var responseJson = @"[
                {
                    ""id"": ""user-list-1"",
                    ""status"": ""ACTIVE"",
                    ""created"": ""2025-10-05T12:00:00.000Z"",
                    ""activated"": ""2025-10-05T12:00:00.000Z"",
                    ""statusChanged"": ""2025-10-05T12:00:00.000Z"",
                    ""lastLogin"": null,
                    ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                    ""passwordChanged"": ""2025-10-05T12:00:00.000Z"",
                    ""profile"": {
                        ""firstName"": ""User"",
                        ""lastName"": ""One"",
                        ""email"": ""user1@example.com"",
                        ""login"": ""user1@example.com""
                    },
                    ""credentials"": {
                        ""password"": {},
                        ""provider"": {
                            ""type"": ""OKTA"",
                            ""name"": ""OKTA""
                        }
                    },
                    ""_links"": {
                        ""self"": {
                            ""href"": ""https://test.okta.com/api/v1/users/user-list-1""
                        }
                    }
                },
                {
                    ""id"": ""user-list-2"",
                    ""status"": ""ACTIVE"",
                    ""created"": ""2025-10-05T13:00:00.000Z"",
                    ""activated"": ""2025-10-05T13:00:00.000Z"",
                    ""statusChanged"": ""2025-10-05T13:00:00.000Z"",
                    ""lastLogin"": null,
                    ""lastUpdated"": ""2025-10-05T13:00:00.000Z"",
                    ""passwordChanged"": ""2025-10-05T13:00:00.000Z"",
                    ""profile"": {
                        ""firstName"": ""User"",
                        ""lastName"": ""Two"",
                        ""email"": ""user2@example.com"",
                        ""login"": ""user2@example.com""
                    },
                    ""credentials"": {
                        ""password"": {},
                        ""provider"": {
                            ""type"": ""OKTA"",
                            ""name"": ""OKTA""
                        }
                    },
                    ""_links"": {
                        ""self"": {
                            ""href"": ""https://test.okta.com/api/v1/users/user-list-2""
                        }
                    }
                }
            ]";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var users = await userApi.ListUsersWithHttpInfoAsync(limit: 10);

            // Assert
            users.Should().NotBeNull();
            users.Data.Should().HaveCount(2);
            users.Data[0].Id.Should().Be("user-list-1");
            users.Data[1].Id.Should().Be("user-list-2");

            mockClient.ReceivedPath.Should().Be("/api/v1/users");
        }

        [Fact]
        public async Task ListUsers_WithSearch_IncludesSearchParameter()
        {
            // Arrange
            var searchQuery = "profile.email eq \"test@example.com\"";
            var responseJson = @"[
                {
                    ""id"": ""user-search-1"",
                    ""status"": ""ACTIVE"",
                    ""created"": ""2025-10-05T12:00:00.000Z"",
                    ""activated"": ""2025-10-05T12:00:00.000Z"",
                    ""statusChanged"": ""2025-10-05T12:00:00.000Z"",
                    ""lastLogin"": null,
                    ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                    ""passwordChanged"": ""2025-10-05T12:00:00.000Z"",
                    ""profile"": {
                        ""firstName"": ""Search"",
                        ""lastName"": ""User"",
                        ""email"": ""test@example.com"",
                        ""login"": ""test@example.com""
                    },
                    ""credentials"": {
                        ""password"": {},
                        ""provider"": {
                            ""type"": ""OKTA"",
                            ""name"": ""OKTA""
                        }
                    },
                    ""_links"": {
                        ""self"": {
                            ""href"": ""https://test.okta.com/api/v1/users/user-search-1""
                        }
                    }
                }
            ]";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var users = await userApi.ListUsersWithHttpInfoAsync(search: searchQuery);

            // Assert
            users.Should().NotBeNull();
            users.Data.Should().HaveCount(1);
            users.Data[0].Profile.Email.Should().Be("test@example.com");

            mockClient.ReceivedPath.Should().Be("/api/v1/users");
            mockClient.ReceivedQueryParams.Should().NotBeNull();
        }

        [Fact]
        public async Task ListUsers_WithFilter_IncludesFilterParameter()
        {
            // Arrange
            var filter = "status eq \"ACTIVE\"";
            var responseJson = @"[
                {
                    ""id"": ""user-filter-1"",
                    ""status"": ""ACTIVE"",
                    ""created"": ""2025-10-05T12:00:00.000Z"",
                    ""activated"": ""2025-10-05T12:00:00.000Z"",
                    ""statusChanged"": ""2025-10-05T12:00:00.000Z"",
                    ""lastLogin"": null,
                    ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                    ""passwordChanged"": ""2025-10-05T12:00:00.000Z"",
                    ""profile"": {
                        ""firstName"": ""Active"",
                        ""lastName"": ""User"",
                        ""email"": ""active@example.com"",
                        ""login"": ""active@example.com""
                    },
                    ""credentials"": {
                        ""password"": {},
                        ""provider"": {
                            ""type"": ""OKTA"",
                            ""name"": ""OKTA""
                        }
                    },
                    ""_links"": {
                        ""self"": {
                            ""href"": ""https://test.okta.com/api/v1/users/user-filter-1""
                        }
                    }
                }
            ]";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var users = await userApi.ListUsersWithHttpInfoAsync(filter: filter);

            // Assert
            users.Should().NotBeNull();
            users.Data.Should().HaveCount(1);
            users.Data[0].Status.Should().Be(UserStatus.ACTIVE);

            mockClient.ReceivedPath.Should().Be("/api/v1/users");
        }

        [Fact]
        public async Task ListUsers_CallsCorrectEndpoint()
        {
            // Arrange
            var responseJson = @"[]";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var users = await userApi.ListUsersWithHttpInfoAsync();

            // Assert
            users.Should().NotBeNull();
            mockClient.ReceivedPath.Should().Be("/api/v1/users");
        }

        #endregion

        #region ListUserBlocks Tests

        [Fact]
        public async Task ListUserBlocks_ReturnsUserBlocks()
        {
            // Arrange
            var userId = "user-blocks-123";
            var responseJson = @"[]";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var blocks = await userApi.ListUserBlocksWithHttpInfoAsync(userId);

            // Assert
            blocks.Should().NotBeNull();
            blocks.Data.Should().BeEmpty();

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{id}/blocks");
            mockClient.ReceivedPathParams.Should().ContainKey("id");
            mockClient.ReceivedPathParams["id"].Should().Contain(userId);
        }

        [Fact]
        public async Task ListUserBlocks_CallsCorrectEndpoint()
        {
            // Arrange
            var userId = "user-blocks-456";
            var responseJson = @"[]";

            var mockClient = new MockAsyncClient(responseJson);
            var userApi = new UserApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var blocks = await userApi.ListUserBlocksWithHttpInfoAsync(userId);

            // Assert
            blocks.Should().NotBeNull();
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{id}/blocks");
            mockClient.ReceivedPathParams.Should().ContainKey("id");
            mockClient.ReceivedPathParams["id"].Should().Contain(userId);
        }

        #endregion
    }
}
