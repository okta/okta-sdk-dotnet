// <copyright file="UserLinkedObjectApiTests.cs" company="Okta, Inc">
// Copyright (c) 2014-present Okta, Inc. All rights reserved.
// Licensed under the Apache 2.0 license. See the LICENSE file in the project root for full license information.
// </copyright>

/*
 * Okta API
 *
 * Allows customers to easily access the Okta API
 *
 * The version of the OpenAPI document: 5.1.0
 * Contact: devex-public@okta.com
 * Generated by: https://github.com/openapitools/openapi-generator.git
 */

using System.Net;
using System.Threading.Tasks;
using FluentAssertions;
using Okta.Sdk.Api;
using Okta.Sdk.Client;
using Okta.Sdk.UnitTest.Internal;
using Xunit;

namespace Okta.Sdk.UnitTest.Api
{
    /// <summary>
    ///  Class for testing UserLinkedObjectApi
    /// </summary>
    public class UserLinkedObjectApiTests
    {
        #region AssignLinkedObjectValueForPrimary Tests

        [Fact]
        public async Task AssignLinkedObjectValueForPrimary_CallsCorrectEndpoint()
        {
            // Arrange
            var userIdOrLogin = "user-123";
            var primaryRelationshipName = "manager";
            var primaryUserId = "primary-user-456";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await userLinkedObjectApi.AssignLinkedObjectValueForPrimaryAsync(userIdOrLogin, primaryRelationshipName, primaryUserId);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{primaryRelationshipName}/{primaryUserId}");
            mockClient.ReceivedPathParams.Should().ContainKey("userIdOrLogin");
            mockClient.ReceivedPathParams["userIdOrLogin"].Should().Contain(userIdOrLogin);
            mockClient.ReceivedPathParams.Should().ContainKey("primaryRelationshipName");
            mockClient.ReceivedPathParams["primaryRelationshipName"].Should().Contain(primaryRelationshipName);
        }

        [Fact]
        public async Task AssignLinkedObjectValueForPrimary_WithHttpInfo_ReturnsCorrectResponse()
        {
            // Arrange
            var userIdOrLogin = "user-info-123";
            var primaryRelationshipName = "supervisor";
            var primaryUserId = "primary-user-info-456";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var response = await userLinkedObjectApi.AssignLinkedObjectValueForPrimaryWithHttpInfoAsync(userIdOrLogin, primaryRelationshipName, primaryUserId);

            // Assert
            response.Should().NotBeNull();
            response.StatusCode.Should().Be(HttpStatusCode.NoContent);

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{primaryRelationshipName}/{primaryUserId}");
            mockClient.ReceivedPathParams.Should().ContainKey("userIdOrLogin");
            mockClient.ReceivedPathParams["userIdOrLogin"].Should().Contain(userIdOrLogin);
            mockClient.ReceivedPathParams.Should().ContainKey("primaryRelationshipName");
            mockClient.ReceivedPathParams["primaryRelationshipName"].Should().Contain(primaryRelationshipName);
        }

        [Fact]
        public async Task AssignLinkedObjectValueForPrimary_WithMeAsUserId_CallsCorrectEndpoint()
        {
            // Arrange
            var userIdOrLogin = "me";
            var primaryRelationshipName = "manager";
            var primaryUserId = "primary-user-me-456";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await userLinkedObjectApi.AssignLinkedObjectValueForPrimaryAsync(userIdOrLogin, primaryRelationshipName, primaryUserId);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{primaryRelationshipName}/{primaryUserId}");
            mockClient.ReceivedPathParams.Should().ContainKey("userIdOrLogin");
            mockClient.ReceivedPathParams["userIdOrLogin"].Should().Contain("me");
        }

        [Fact]
        public async Task AssignLinkedObjectValueForPrimary_WithUserLogin_CallsCorrectEndpoint()
        {
            // Arrange
            var userIdOrLogin = "user@example.com";
            var primaryRelationshipName = "reports";
            var primaryUserId = "primary-user-login-456";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await userLinkedObjectApi.AssignLinkedObjectValueForPrimaryAsync(userIdOrLogin, primaryRelationshipName, primaryUserId);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{primaryRelationshipName}/{primaryUserId}");
            mockClient.ReceivedPathParams.Should().ContainKey("userIdOrLogin");
            mockClient.ReceivedPathParams["userIdOrLogin"].Should().Contain(userIdOrLogin);
        }

        #endregion

        #region DeleteLinkedObjectForUser Tests

        [Fact]
        public async Task DeleteLinkedObjectForUser_CallsCorrectEndpoint()
        {
            // Arrange
            var userIdOrLogin = "user-delete-123";
            var relationshipName = "manager";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await userLinkedObjectApi.DeleteLinkedObjectForUserAsync(userIdOrLogin, relationshipName);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{relationshipName}");
            mockClient.ReceivedPathParams.Should().ContainKey("userIdOrLogin");
            mockClient.ReceivedPathParams["userIdOrLogin"].Should().Contain(userIdOrLogin);
            mockClient.ReceivedPathParams.Should().ContainKey("relationshipName");
            mockClient.ReceivedPathParams["relationshipName"].Should().Contain(relationshipName);
        }

        [Fact]
        public async Task DeleteLinkedObjectForUser_WithHttpInfo_ReturnsCorrectResponse()
        {
            // Arrange
            var userIdOrLogin = "user-delete-info-123";
            var relationshipName = "supervisor";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var response = await userLinkedObjectApi.DeleteLinkedObjectForUserWithHttpInfoAsync(userIdOrLogin, relationshipName);

            // Assert
            response.Should().NotBeNull();
            response.StatusCode.Should().Be(HttpStatusCode.NoContent);

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{relationshipName}");
            mockClient.ReceivedPathParams.Should().ContainKey("userIdOrLogin");
            mockClient.ReceivedPathParams["userIdOrLogin"].Should().Contain(userIdOrLogin);
            mockClient.ReceivedPathParams.Should().ContainKey("relationshipName");
            mockClient.ReceivedPathParams["relationshipName"].Should().Contain(relationshipName);
        }

        [Fact]
        public async Task DeleteLinkedObjectForUser_WithMeAsUserId_CallsCorrectEndpoint()
        {
            // Arrange
            var userIdOrLogin = "me";
            var relationshipName = "manager";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await userLinkedObjectApi.DeleteLinkedObjectForUserAsync(userIdOrLogin, relationshipName);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{relationshipName}");
            mockClient.ReceivedPathParams.Should().ContainKey("userIdOrLogin");
            mockClient.ReceivedPathParams["userIdOrLogin"].Should().Contain("me");
        }

        [Fact]
        public async Task DeleteLinkedObjectForUser_WithUserLogin_CallsCorrectEndpoint()
        {
            // Arrange
            var userIdOrLogin = "user@delete.com";
            var relationshipName = "reports";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await userLinkedObjectApi.DeleteLinkedObjectForUserAsync(userIdOrLogin, relationshipName);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{relationshipName}");
            mockClient.ReceivedPathParams.Should().ContainKey("userIdOrLogin");
            mockClient.ReceivedPathParams["userIdOrLogin"].Should().Contain(userIdOrLogin);
        }

        [Fact]
        public async Task DeleteLinkedObjectForUser_NonExistentRelationship_ReturnsSuccessfully()
        {
            // Arrange
            var userIdOrLogin = "user-nonexistent-123";
            var relationshipName = "nonexistent";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await userLinkedObjectApi.DeleteLinkedObjectForUserAsync(userIdOrLogin, relationshipName);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{relationshipName}");
            mockClient.ReceivedPathParams.Should().ContainKey("userIdOrLogin");
            mockClient.ReceivedPathParams["userIdOrLogin"].Should().Contain(userIdOrLogin);
            mockClient.ReceivedPathParams.Should().ContainKey("relationshipName");
            mockClient.ReceivedPathParams["relationshipName"].Should().Contain(relationshipName);
        }

        #endregion

        #region ListLinkedObjectsForUser Tests

        [Fact]
        public async Task ListLinkedObjectsForUser_ReturnsLinksList()
        {
            // Arrange
            var userIdOrLogin = "user-list-123";
            var relationshipName = "manager";

            var responseJson = @"[
                {
                    ""_links"": {
                        ""self"": {
                            ""href"": ""https://test.okta.com/api/v1/users/user-list-123/linkedObjects/manager""
                        }
                    }
                },
                {
                    ""_links"": {
                        ""self"": {
                            ""href"": ""https://test.okta.com/api/v1/users/user-list-123/linkedObjects/manager/associated-user-456""
                        }
                    }
                }
            ]";

            var mockClient = new MockAsyncClient(responseJson);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var links = await userLinkedObjectApi.ListLinkedObjectsForUserWithHttpInfoAsync(userIdOrLogin, relationshipName);

            // Assert
            links.Should().NotBeNull();
            links.Data.Should().HaveCount(2);
            links.Data[0].Links.Should().NotBeNull();
            links.Data[1].Links.Should().NotBeNull();

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{relationshipName}");
            mockClient.ReceivedPathParams.Should().ContainKey("userIdOrLogin");
            mockClient.ReceivedPathParams["userIdOrLogin"].Should().Contain(userIdOrLogin);
            mockClient.ReceivedPathParams.Should().ContainKey("relationshipName");
            mockClient.ReceivedPathParams["relationshipName"].Should().Contain(relationshipName);
        }

        [Fact]
        public async Task ListLinkedObjectsForUser_EmptyResponse_ReturnsEmptyList()
        {
            // Arrange
            var userIdOrLogin = "user-empty-123";
            var relationshipName = "manager";
            var responseJson = @"[]";

            var mockClient = new MockAsyncClient(responseJson);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var links = await userLinkedObjectApi.ListLinkedObjectsForUserWithHttpInfoAsync(userIdOrLogin, relationshipName);

            // Assert
            links.Should().NotBeNull();
            links.Data.Should().BeEmpty();

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{relationshipName}");
            mockClient.ReceivedPathParams.Should().ContainKey("userIdOrLogin");
            mockClient.ReceivedPathParams["userIdOrLogin"].Should().Contain(userIdOrLogin);
            mockClient.ReceivedPathParams.Should().ContainKey("relationshipName");
            mockClient.ReceivedPathParams["relationshipName"].Should().Contain(relationshipName);
        }

        [Fact]
        public async Task ListLinkedObjectsForUser_WithMeAsUserId_CallsCorrectEndpoint()
        {
            // Arrange
            var userIdOrLogin = "me";
            var relationshipName = "supervisor";
            var responseJson = @"[]";

            var mockClient = new MockAsyncClient(responseJson);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var links = await userLinkedObjectApi.ListLinkedObjectsForUserWithHttpInfoAsync(userIdOrLogin, relationshipName);

            // Assert
            links.Should().NotBeNull();
            links.Data.Should().BeEmpty();

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{relationshipName}");
            mockClient.ReceivedPathParams.Should().ContainKey("userIdOrLogin");
            mockClient.ReceivedPathParams["userIdOrLogin"].Should().Contain("me");
        }

        [Fact]
        public async Task ListLinkedObjectsForUser_WithUserLogin_CallsCorrectEndpoint()
        {
            // Arrange
            var userIdOrLogin = "user@list.com";
            var relationshipName = "reports";
            var responseJson = @"[]";

            var mockClient = new MockAsyncClient(responseJson);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var links = await userLinkedObjectApi.ListLinkedObjectsForUserWithHttpInfoAsync(userIdOrLogin, relationshipName);

            // Assert
            links.Should().NotBeNull();
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{relationshipName}");
            mockClient.ReceivedPathParams.Should().ContainKey("userIdOrLogin");
            mockClient.ReceivedPathParams["userIdOrLogin"].Should().Contain(userIdOrLogin);
        }

        [Fact]
        public async Task ListLinkedObjectsForUser_SinglePrimaryUser_ReturnsCorrectStructure()
        {
            // Arrange
            var userIdOrLogin = "user-single-123";
            var relationshipName = "manager";

            var responseJson = @"[
                {
                    ""_links"": {
                        ""self"": {
                            ""href"": ""https://test.okta.com/api/v1/users/user-single-123/linkedObjects/manager""
                        }
                    }
                }
            ]";

            var mockClient = new MockAsyncClient(responseJson);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var links = await userLinkedObjectApi.ListLinkedObjectsForUserWithHttpInfoAsync(userIdOrLogin, relationshipName);

            // Assert
            links.Should().NotBeNull();
            links.Data.Should().HaveCount(1);
            links.Data[0].Links.Should().NotBeNull();

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{relationshipName}");
            mockClient.ReceivedPathParams.Should().ContainKey("userIdOrLogin");
            mockClient.ReceivedPathParams["userIdOrLogin"].Should().Contain(userIdOrLogin);
        }

        [Fact]
        public async Task ListLinkedObjectsForUser_CallsCorrectEndpoint()
        {
            // Arrange
            var userIdOrLogin = "user-endpoint-123";
            var relationshipName = "associated";
            var responseJson = @"[]";

            var mockClient = new MockAsyncClient(responseJson);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var links = await userLinkedObjectApi.ListLinkedObjectsForUserWithHttpInfoAsync(userIdOrLogin, relationshipName);

            // Assert
            links.Should().NotBeNull();
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{relationshipName}");
            mockClient.ReceivedPathParams.Should().ContainKey("userIdOrLogin");
            mockClient.ReceivedPathParams["userIdOrLogin"].Should().Contain(userIdOrLogin);
            mockClient.ReceivedPathParams.Should().ContainKey("relationshipName");
            mockClient.ReceivedPathParams["relationshipName"].Should().Contain(relationshipName);
        }

        [Fact]
        public async Task ListLinkedObjectsForUser_MultipleAssociatedUsers_ReturnsCorrectStructure()
        {
            // Arrange
            var userIdOrLogin = "manager-user-123";
            var relationshipName = "direct-reports";

            var responseJson = @"[
                {
                    ""_links"": {
                        ""self"": {
                            ""href"": ""https://test.okta.com/api/v1/users/manager-user-123/linkedObjects/directreports/employee1""
                        }
                    }
                },
                {
                    ""_links"": {
                        ""self"": {
                            ""href"": ""https://test.okta.com/api/v1/users/manager-user-123/linkedObjects/directreports/employee2""
                        }
                    }
                },
                {
                    ""_links"": {
                        ""self"": {
                            ""href"": ""https://test.okta.com/api/v1/users/manager-user-123/linkedObjects/directreports/employee3""
                        }
                    }
                }
            ]";

            var mockClient = new MockAsyncClient(responseJson);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var links = await userLinkedObjectApi.ListLinkedObjectsForUserWithHttpInfoAsync(userIdOrLogin, relationshipName);

            // Assert
            links.Should().NotBeNull();
            links.Data.Should().HaveCount(3);
            links.Data[0].Links.Should().NotBeNull();
            links.Data[1].Links.Should().NotBeNull();
            links.Data[2].Links.Should().NotBeNull();

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{relationshipName}");
            mockClient.ReceivedPathParams.Should().ContainKey("userIdOrLogin");
            mockClient.ReceivedPathParams["userIdOrLogin"].Should().Contain(userIdOrLogin);
            mockClient.ReceivedPathParams.Should().ContainKey("relationshipName");
            mockClient.ReceivedPathParams["relationshipName"].Should().Contain(relationshipName);
        }

        #endregion

        #region Additional Edge Case Tests

        [Fact]
        public async Task AssignLinkedObjectValueForPrimary_WithSpecialCharactersInRelationshipName_CallsCorrectEndpoint()
        {
            // Arrange
            var userIdOrLogin = "user-special-123";
            var primaryRelationshipName = "manager-level-1";
            var primaryUserId = "primary-special-456";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await userLinkedObjectApi.AssignLinkedObjectValueForPrimaryAsync(userIdOrLogin, primaryRelationshipName, primaryUserId);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{primaryRelationshipName}/{primaryUserId}");
            mockClient.ReceivedPathParams.Should().ContainKey("primaryRelationshipName");
            mockClient.ReceivedPathParams["primaryRelationshipName"].Should().Contain(primaryRelationshipName);
        }

        [Fact]
        public async Task DeleteLinkedObjectForUser_WithSpecialCharactersInRelationshipName_CallsCorrectEndpoint()
        {
            // Arrange
            var userIdOrLogin = "user-special-delete-123";
            var relationshipName = "direct_reports";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await userLinkedObjectApi.DeleteLinkedObjectForUserAsync(userIdOrLogin, relationshipName);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{relationshipName}");
            mockClient.ReceivedPathParams.Should().ContainKey("relationshipName");
            mockClient.ReceivedPathParams["relationshipName"].Should().Contain(relationshipName);
        }

        [Fact]
        public async Task ListLinkedObjectsForUser_WithSpecialCharactersInRelationshipName_CallsCorrectEndpoint()
        {
            // Arrange
            var userIdOrLogin = "user-special-list-123";
            var relationshipName = "team_lead";
            var responseJson = @"[]";

            var mockClient = new MockAsyncClient(responseJson);
            var userLinkedObjectApi = new UserLinkedObjectApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var links = await userLinkedObjectApi.ListLinkedObjectsForUserWithHttpInfoAsync(userIdOrLogin, relationshipName);

            // Assert
            links.Should().NotBeNull();
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userIdOrLogin}/linkedObjects/{relationshipName}");
            mockClient.ReceivedPathParams.Should().ContainKey("relationshipName");
            mockClient.ReceivedPathParams["relationshipName"].Should().Contain(relationshipName);
        }

        #endregion
    }
}
