// <copyright file="UserAuthenticatorEnrollmentsApiTests.cs" company="Okta, Inc">
// Copyright (c) 2014-present Okta, Inc. All rights reserved.
// Licensed under the Apache 2.0 license. See the LICENSE file in the project root for full license information.
// </copyright>

/*
 * Okta API
 *
 * Allows customers to easily access the Okta API
 *
 * The version of the OpenAPI document: 5.1.0
 * Contact: devex-public@okta.com
 * Generated by: https://github.com/openapitools/openapi-generator.git
 */

using System.Net;
using System.Threading.Tasks;
using FluentAssertions;
using Okta.Sdk.Api;
using Okta.Sdk.Client;
using Okta.Sdk.Model;
using Okta.Sdk.UnitTest.Internal;
using Xunit;

namespace Okta.Sdk.UnitTest.Api
{
    /// <summary>
    ///  Class for testing UserAuthenticatorEnrollmentsApi
    /// </summary>
    public class UserAuthenticatorEnrollmentsApiTests
    {
        #region CreateAuthenticatorEnrollment Tests

        [Fact]
        public async Task CreateAuthenticatorEnrollment_WithValidPhoneEnrollment_ReturnsEnrollment()
        {
            // Arrange
            var userId = "user-123";
            var enrollmentId = "enrollment-456";
            var phoneNumber = "+1-555-123-4567";

            var responseJson = @"{
                ""id"": """ + enrollmentId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-07T12:00:00.000Z"",
                ""lastUpdated"": ""2025-10-07T12:00:00.000Z"",
                ""type"": ""phone"",
                ""profile"": {
                    ""phoneNumber"": """ + phoneNumber + @"""
                },
                ""authenticator"": {
                    ""id"": ""authenticator-123"",
                    ""key"": ""phone_number"",
                    ""type"": ""phone"",
                    ""displayName"": ""Phone""
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"/authenticator-enrollments/" + enrollmentId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson, HttpStatusCode.Created);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            var createRequest = new AuthenticatorEnrollmentCreateRequest();

            // Act
            var result = await api.CreateAuthenticatorEnrollmentAsync(userId, createRequest);

            // Assert
            result.Should().NotBeNull();
            result.Id.Should().Be(enrollmentId);
            result.Status.Should().Be("ACTIVE");
            result.Type.Should().Be(AuthenticatorType.Phone);

            mockClient.ReceivedPath.Should().Be("/api/v1/users/{userId}/authenticator-enrollments/phone");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
            mockClient.ReceivedBody.Should().NotBeNullOrEmpty();
        }

        [Fact]
        public async Task CreateAuthenticatorEnrollment_WithHttpInfo_ReturnsCorrectResponse()
        {
            // Arrange
            var userId = "user-http-123";
            var enrollmentId = "enrollment-http-456";

            var responseJson = @"{
                ""id"": """ + enrollmentId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-07T12:00:00.000Z"",
                ""lastUpdated"": ""2025-10-07T12:00:00.000Z"",
                ""type"": ""phone"",
                ""profile"": {
                    ""phoneNumber"": ""+1-555-987-6543""
                },
                ""authenticator"": {
                    ""id"": ""authenticator-http-123"",
                    ""key"": ""phone_number"",
                    ""type"": ""phone"",
                    ""displayName"": ""Phone""
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"/authenticator-enrollments/" + enrollmentId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson, HttpStatusCode.Created);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            var createRequest = new AuthenticatorEnrollmentCreateRequest();

            // Act
            var response = await api.CreateAuthenticatorEnrollmentWithHttpInfoAsync(userId, createRequest);

            // Assert
            response.Should().NotBeNull();
            response.StatusCode.Should().Be(HttpStatusCode.Created);
            response.Data.Should().NotBeNull();
            response.Data.Id.Should().Be(enrollmentId);
            response.Data.Type.Should().Be(AuthenticatorType.Phone);

            mockClient.ReceivedPath.Should().Be("/api/v1/users/{userId}/authenticator-enrollments/phone");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
        }

        [Fact]
        public async Task CreateAuthenticatorEnrollment_ValidatesRequiredUserId()
        {
            // Arrange
            var createRequest = new AuthenticatorEnrollmentCreateRequest();
            var mockClient = new MockAsyncClient("", HttpStatusCode.BadRequest);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act & Assert
            await Assert.ThrowsAsync<ApiException>(
                () => api.CreateAuthenticatorEnrollmentAsync(null, createRequest));
        }

        [Fact]
        public async Task CreateAuthenticatorEnrollment_ValidatesRequiredRequest()
        {
            // Arrange
            var userId = "user-no-request-123";
            var mockClient = new MockAsyncClient("", HttpStatusCode.BadRequest);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act & Assert
            await Assert.ThrowsAsync<ApiException>(
                () => api.CreateAuthenticatorEnrollmentAsync(userId, null));
        }

        #endregion

        #region CreateTacAuthenticatorEnrollment Tests

        [Fact]
        public async Task CreateTacAuthenticatorEnrollment_WithValidRequest_ReturnsTacEnrollment()
        {
            // Arrange
            var userId = "user-tac-123";
            var enrollmentId = "tac-enrollment-456";

            var responseJson = @"{
                ""id"": """ + enrollmentId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-07T12:00:00.000Z"",
                ""lastUpdated"": ""2025-10-07T12:00:00.000Z"",
                ""type"": ""security_key"",
                ""authenticator"": {
                    ""id"": ""tac-authenticator-123"",
                    ""key"": ""okta_temporary_access_codes"",
                    ""type"": ""security_key"",
                    ""displayName"": ""Temporary Access Codes""
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"/authenticator-enrollments/" + enrollmentId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson, HttpStatusCode.Created);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            var tacRequest = new AuthenticatorEnrollmentCreateRequestTac();

            // Act
            var result = await api.CreateTacAuthenticatorEnrollmentAsync(userId, tacRequest);

            // Assert
            result.Should().NotBeNull();
            result.Id.Should().Be(enrollmentId);
            result.Status.Should().Be("ACTIVE");

            mockClient.ReceivedPath.Should().Be("/api/v1/users/{userId}/authenticator-enrollments/tac");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
            mockClient.ReceivedBody.Should().NotBeNullOrEmpty();
        }

        [Fact]
        public async Task CreateTacAuthenticatorEnrollment_WithHttpInfo_ReturnsCorrectResponse()
        {
            // Arrange
            var userId = "user-tac-http-123";
            var enrollmentId = "tac-enrollment-http-456";

            var responseJson = @"{
                ""id"": """ + enrollmentId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-07T12:00:00.000Z"",
                ""lastUpdated"": ""2025-10-07T12:00:00.000Z"",
                ""type"": ""security_key"",
                ""authenticator"": {
                    ""id"": ""tac-http-authenticator-123"",
                    ""key"": ""okta_temporary_access_codes"",
                    ""type"": ""security_key"",
                    ""displayName"": ""Temporary Access Codes""
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"/authenticator-enrollments/" + enrollmentId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson, HttpStatusCode.Created);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            var tacRequest = new AuthenticatorEnrollmentCreateRequestTac();

            // Act
            var response = await api.CreateTacAuthenticatorEnrollmentWithHttpInfoAsync(userId, tacRequest);

            // Assert
            response.Should().NotBeNull();
            response.StatusCode.Should().Be(HttpStatusCode.Created);
            response.Data.Should().NotBeNull();
            response.Data.Id.Should().Be(enrollmentId);

            mockClient.ReceivedPath.Should().Be("/api/v1/users/{userId}/authenticator-enrollments/tac");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
        }

        [Fact]
        public async Task CreateTacAuthenticatorEnrollment_ValidatesRequiredUserId()
        {
            // Arrange
            var tacRequest = new AuthenticatorEnrollmentCreateRequestTac();
            var mockClient = new MockAsyncClient("", HttpStatusCode.BadRequest);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act & Assert
            await Assert.ThrowsAsync<ApiException>(
                () => api.CreateTacAuthenticatorEnrollmentAsync(null, tacRequest));
        }

        [Fact]
        public async Task CreateTacAuthenticatorEnrollment_ValidatesRequiredRequest()
        {
            // Arrange
            var userId = "user-tac-no-request-123";
            var mockClient = new MockAsyncClient("", HttpStatusCode.BadRequest);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act & Assert
            await Assert.ThrowsAsync<ApiException>(
                () => api.CreateTacAuthenticatorEnrollmentAsync(userId, null));
        }

        #endregion

        #region DeleteAuthenticatorEnrollment Tests

        [Fact]
        public async Task DeleteAuthenticatorEnrollment_WithValidIds_CallsCorrectEndpoint()
        {
            // Arrange
            var userId = "user-delete-123";
            var enrollmentId = "enrollment-delete-456";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await api.DeleteAuthenticatorEnrollmentAsync(userId, enrollmentId);

            // Assert
            mockClient.ReceivedPath.Should().Be("/api/v1/users/{userId}/authenticator-enrollments/{enrollmentId}");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
            mockClient.ReceivedPathParams.Should().ContainKey("enrollmentId");
            mockClient.ReceivedPathParams["enrollmentId"].Should().Contain(enrollmentId);
        }

        [Fact]
        public async Task DeleteAuthenticatorEnrollment_WithHttpInfo_ReturnsCorrectResponse()
        {
            // Arrange
            var userId = "user-delete-http-123";
            var enrollmentId = "enrollment-delete-http-456";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var response = await api.DeleteAuthenticatorEnrollmentWithHttpInfoAsync(userId, enrollmentId);

            // Assert
            response.Should().NotBeNull();
            response.StatusCode.Should().Be(HttpStatusCode.NoContent);

            mockClient.ReceivedPath.Should().Be("/api/v1/users/{userId}/authenticator-enrollments/{enrollmentId}");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
            mockClient.ReceivedPathParams.Should().ContainKey("enrollmentId");
            mockClient.ReceivedPathParams["enrollmentId"].Should().Contain(enrollmentId);
        }

        [Fact]
        public async Task DeleteAuthenticatorEnrollment_ValidatesRequiredUserId()
        {
            // Arrange
            var enrollmentId = "enrollment-123";
            var mockClient = new MockAsyncClient("", HttpStatusCode.BadRequest);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act & Assert
            await Assert.ThrowsAsync<ApiException>(
                () => api.DeleteAuthenticatorEnrollmentAsync(null, enrollmentId));
        }

        [Fact]
        public async Task DeleteAuthenticatorEnrollment_ValidatesRequiredEnrollmentId()
        {
            // Arrange
            var userId = "user-123";
            var mockClient = new MockAsyncClient("", HttpStatusCode.BadRequest);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act & Assert
            await Assert.ThrowsAsync<ApiException>(
                () => api.DeleteAuthenticatorEnrollmentAsync(userId, null));
        }

        #endregion

        #region GetAuthenticatorEnrollment Tests

        [Fact]
        public async Task GetAuthenticatorEnrollment_WithValidIds_ReturnsEnrollment()
        {
            // Arrange
            var userId = "user-get-123";
            var enrollmentId = "enrollment-get-456";

            var responseJson = @"{
                ""id"": """ + enrollmentId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-07T12:00:00.000Z"",
                ""lastUpdated"": ""2025-10-07T12:00:00.000Z"",
                ""type"": ""app"",
                ""profile"": {
                    ""deviceName"": ""iPhone 13"",
                    ""platform"": ""IOS""
                },
                ""authenticator"": {
                    ""id"": ""authenticator-get-123"",
                    ""key"": ""okta_verify"",
                    ""type"": ""app"",
                    ""displayName"": ""Okta Verify""
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"/authenticator-enrollments/" + enrollmentId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var result = await api.GetAuthenticatorEnrollmentAsync(userId, enrollmentId);

            // Assert
            result.Should().NotBeNull();
            result.Id.Should().Be(enrollmentId);
            result.Status.Should().Be("ACTIVE");
            result.Type.Should().Be(AuthenticatorType.App);

            mockClient.ReceivedPath.Should().Be("/api/v1/users/{userId}/authenticator-enrollments/{enrollmentId}");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
            mockClient.ReceivedPathParams.Should().ContainKey("enrollmentId");
            mockClient.ReceivedPathParams["enrollmentId"].Should().Contain(enrollmentId);
        }

        [Fact]
        public async Task GetAuthenticatorEnrollment_WithHttpInfo_ReturnsCorrectResponse()
        {
            // Arrange
            var userId = "user-get-http-123";
            var enrollmentId = "enrollment-get-http-456";

            var responseJson = @"{
                ""id"": """ + enrollmentId + @""",
                ""status"": ""PENDING"",
                ""created"": ""2025-10-07T12:00:00.000Z"",
                ""lastUpdated"": ""2025-10-07T12:00:00.000Z"",
                ""type"": ""email"",
                ""profile"": {
                    ""email"": ""user@example.com""
                },
                ""authenticator"": {
                    ""id"": ""authenticator-http-get-123"",
                    ""key"": ""okta_email"",
                    ""type"": ""email"",
                    ""displayName"": ""Email""
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"/authenticator-enrollments/" + enrollmentId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var response = await api.GetAuthenticatorEnrollmentWithHttpInfoAsync(userId, enrollmentId);

            // Assert
            response.Should().NotBeNull();
            response.StatusCode.Should().Be(HttpStatusCode.OK);
            response.Data.Should().NotBeNull();
            response.Data.Id.Should().Be(enrollmentId);
            response.Data.Status.Should().Be("PENDING");
            response.Data.Type.Should().Be(AuthenticatorType.Email);

            mockClient.ReceivedPath.Should().Be("/api/v1/users/{userId}/authenticator-enrollments/{enrollmentId}");
        }

        [Fact]
        public async Task GetAuthenticatorEnrollment_ValidatesRequiredUserId()
        {
            // Arrange
            var enrollmentId = "enrollment-123";
            var mockClient = new MockAsyncClient("", HttpStatusCode.BadRequest);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act & Assert
            await Assert.ThrowsAsync<ApiException>(
                () => api.GetAuthenticatorEnrollmentAsync(null, enrollmentId));
        }

        [Fact]
        public async Task GetAuthenticatorEnrollment_ValidatesRequiredEnrollmentId()
        {
            // Arrange
            var userId = "user-123";
            var mockClient = new MockAsyncClient("", HttpStatusCode.BadRequest);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act & Assert
            await Assert.ThrowsAsync<ApiException>(
                () => api.GetAuthenticatorEnrollmentAsync(userId, null));
        }

        #endregion

        #region ListAuthenticatorEnrollments Tests

        [Fact]
        public async Task ListAuthenticatorEnrollments_WithValidUserId_ReturnsEnrollments()
        {
            // Arrange
            var userId = "user-list-123";

            var responseJson = @"{
                ""enrollments"": [
                    {
                        ""id"": ""enrollment-list-1"",
                        ""status"": ""ACTIVE"",
                        ""created"": ""2025-10-07T12:00:00.000Z"",
                        ""lastUpdated"": ""2025-10-07T12:00:00.000Z"",
                        ""type"": ""phone"",
                        ""profile"": {
                            ""phoneNumber"": ""+1-555-111-2222""
                        },
                        ""authenticator"": {
                            ""id"": ""authenticator-list-1"",
                            ""key"": ""phone_number"",
                            ""type"": ""phone"",
                            ""displayName"": ""Phone""
                        }
                    },
                    {
                        ""id"": ""enrollment-list-2"",
                        ""status"": ""ACTIVE"",
                        ""created"": ""2025-10-07T11:00:00.000Z"",
                        ""lastUpdated"": ""2025-10-07T11:00:00.000Z"",
                        ""type"": ""app"",
                        ""profile"": {
                            ""deviceName"": ""Android Phone"",
                            ""platform"": ""ANDROID""
                        },
                        ""authenticator"": {
                            ""id"": ""authenticator-list-2"",
                            ""key"": ""okta_verify"",
                            ""type"": ""app"",
                            ""displayName"": ""Okta Verify""
                        }
                    }
                ]
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var result = await api.ListAuthenticatorEnrollmentsAsync(userId);

            // Assert
            result.Should().NotBeNull();

            mockClient.ReceivedPath.Should().Be("/api/v1/users/{userId}/authenticator-enrollments");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
        }

        [Fact]
        public async Task ListAuthenticatorEnrollments_WithHttpInfo_ReturnsCorrectResponse()
        {
            // Arrange
            var userId = "user-list-http-123";

            var responseJson = @"{
                ""enrollments"": [
                    {
                        ""id"": ""enrollment-http-list-1"",
                        ""status"": ""ACTIVE"",
                        ""created"": ""2025-10-07T12:00:00.000Z"",
                        ""lastUpdated"": ""2025-10-07T12:00:00.000Z"",
                        ""type"": ""email"",
                        ""profile"": {
                            ""email"": ""user@example.com""
                        },
                        ""authenticator"": {
                            ""id"": ""authenticator-http-list-1"",
                            ""key"": ""okta_email"",
                            ""type"": ""email"",
                            ""displayName"": ""Email""
                        }
                    }
                ]
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var response = await api.ListAuthenticatorEnrollmentsWithHttpInfoAsync(userId);

            // Assert
            response.Should().NotBeNull();
            response.StatusCode.Should().Be(HttpStatusCode.OK);
            response.Data.Should().NotBeNull();

            mockClient.ReceivedPath.Should().Be("/api/v1/users/{userId}/authenticator-enrollments");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
        }

        [Fact]
        public async Task ListAuthenticatorEnrollments_ValidatesRequiredUserId()
        {
            // Arrange
            var mockClient = new MockAsyncClient("", HttpStatusCode.BadRequest);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act & Assert
            await Assert.ThrowsAsync<ApiException>(
                () => api.ListAuthenticatorEnrollmentsAsync(null));
        }

        [Fact]
        public async Task ListAuthenticatorEnrollments_ReturnsEmptyList_WhenNoEnrollments()
        {
            // Arrange
            var userId = "user-empty-list-123";
            var responseJson = @"{""enrollments"": []}";

            var mockClient = new MockAsyncClient(responseJson);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var response = await api.ListAuthenticatorEnrollmentsWithHttpInfoAsync(userId);

            // Assert
            response.Should().NotBeNull();
            response.StatusCode.Should().Be(HttpStatusCode.OK);
            response.Data.Should().NotBeNull();

            mockClient.ReceivedPath.Should().Be("/api/v1/users/{userId}/authenticator-enrollments");
        }

        #endregion

        #region Edge Case Tests

        [Fact]
        public async Task GetAuthenticatorEnrollment_WithSpecialCharactersInUserId_CallsCorrectEndpoint()
        {
            // Arrange
            var userId = "user@special-domain.com";
            var enrollmentId = "enrollment-special-123";

            var responseJson = @"{
                ""id"": """ + enrollmentId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-07T12:00:00.000Z"",
                ""lastUpdated"": ""2025-10-07T12:00:00.000Z"",
                ""type"": ""phone"",
                ""authenticator"": {
                    ""id"": ""authenticator-special-123"",
                    ""key"": ""phone_number"",
                    ""type"": ""phone"",
                    ""displayName"": ""Phone""
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var result = await api.GetAuthenticatorEnrollmentAsync(userId, enrollmentId);

            // Assert
            result.Should().NotBeNull();
            result.Id.Should().Be(enrollmentId);

            mockClient.ReceivedPath.Should().Be("/api/v1/users/{userId}/authenticator-enrollments/{enrollmentId}");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
        }

        [Fact]
        public async Task DeleteAuthenticatorEnrollment_WithComplexEnrollmentId_CallsCorrectEndpoint()
        {
            // Arrange
            var userId = "user-complex-123";
            var enrollmentId = "enrollment-complex_456-test.enrollment";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await api.DeleteAuthenticatorEnrollmentAsync(userId, enrollmentId);

            // Assert
            mockClient.ReceivedPath.Should().Be("/api/v1/users/{userId}/authenticator-enrollments/{enrollmentId}");
            mockClient.ReceivedPathParams.Should().ContainKey("enrollmentId");
            mockClient.ReceivedPathParams["enrollmentId"].Should().Contain(enrollmentId);
        }

        #endregion

        #region HTTP Status Code Tests

        [Fact]
        public async Task CreateAuthenticatorEnrollment_WithCreatedStatus_ReturnsCorrectResponse()
        {
            // Arrange
            var userId = "user-created-123";
            var enrollmentId = "enrollment-created-456";

            var responseJson = @"{
                ""id"": """ + enrollmentId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-07T12:00:00.000Z"",
                ""lastUpdated"": ""2025-10-07T12:00:00.000Z"",
                ""type"": ""phone"",
                ""authenticator"": {
                    ""id"": ""authenticator-created-123"",
                    ""key"": ""phone_number"",
                    ""type"": ""phone"",
                    ""displayName"": ""Phone""
                }
            }";

            var mockClient = new MockAsyncClient(responseJson, HttpStatusCode.Created);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            var createRequest = new AuthenticatorEnrollmentCreateRequest();

            // Act
            var response = await api.CreateAuthenticatorEnrollmentWithHttpInfoAsync(userId, createRequest);

            // Assert
            response.Should().NotBeNull();
            response.StatusCode.Should().Be(HttpStatusCode.Created);
            response.Data.Should().NotBeNull();
            response.Data.Id.Should().Be(enrollmentId);
        }

        [Fact]
        public async Task GetAuthenticatorEnrollment_WithNotFoundStatus_ThrowsApiException()
        {
            // Arrange
            var userId = "user-not-found-123";
            var enrollmentId = "non-existent-enrollment";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NotFound);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act & Assert
            var exception = await Assert.ThrowsAsync<ApiException>(
                () => api.GetAuthenticatorEnrollmentWithHttpInfoAsync(userId, enrollmentId));

            // Verify the call was made to the correct endpoint
            mockClient.ReceivedPath.Should().Be("/api/v1/users/{userId}/authenticator-enrollments/{enrollmentId}");
            exception.Should().NotBeNull();
        }

        [Fact]
        public async Task CreateTacAuthenticatorEnrollment_WithBadRequestStatus_ThrowsApiException()
        {
            // Arrange
            var userId = "user-bad-request-123";
            var tacRequest = new AuthenticatorEnrollmentCreateRequestTac();

            var mockClient = new MockAsyncClient("", HttpStatusCode.BadRequest);
            var api = new UserAuthenticatorEnrollmentsApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act & Assert
            var exception = await Assert.ThrowsAsync<ApiException>(
                () => api.CreateTacAuthenticatorEnrollmentWithHttpInfoAsync(userId, tacRequest));

            // Verify the call was made to the correct endpoint
            mockClient.ReceivedPath.Should().Be("/api/v1/users/{userId}/authenticator-enrollments/tac");
            exception.Should().NotBeNull();
        }

        #endregion
    }
}
