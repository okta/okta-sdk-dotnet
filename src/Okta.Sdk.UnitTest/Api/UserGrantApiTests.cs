// <copyright file="UserGrantApiTests.cs" company="Okta, Inc">
// Copyright (c) 2014-present Okta, Inc. All rights reserved.
// Licensed under the Apache 2.0 license. See the LICENSE file in the project root for full license information.
// </copyright>

/*
 * Okta API
 *
 * Allows customers to easily access the Okta API
 *
 * The version of the OpenAPI document: 5.1.0
 * Contact: devex-public@okta.com
 * Generated by: https://github.com/openapitools/openapi-generator.git
 */

using System.Net;
using System.Threading.Tasks;
using FluentAssertions;
using Okta.Sdk.Api;
using Okta.Sdk.Client;
using Okta.Sdk.Model;
using Okta.Sdk.UnitTest.Internal;
using Xunit;

namespace Okta.Sdk.UnitTest.Api
{
    /// <summary>
    ///  Class for testing UserGrantApi
    /// </summary>
    public class UserGrantApiTests
    {
        #region GetUserGrant Tests

        [Fact]
        public async Task GetUserGrant_ReturnsGrant()
        {
            // Arrange
            var userId = "user-123";
            var grantId = "grant-456";
            var clientId = "client-789";
            var scopeId = "openid";

            var responseJson = @"{
                ""id"": """ + grantId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-05T12:00:00.000Z"",
                ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                ""issuer"": ""https://test.okta.com/oauth2/default"",
                ""clientId"": """ + clientId + @""",
                ""userId"": """ + userId + @""",
                ""scopeId"": """ + scopeId + @""",
                ""source"": ""END_USER"",
                ""createdBy"": {
                    ""id"": """ + userId + @""",
                    ""type"": ""User""
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"/grants/" + grantId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var grant = await userGrantApi.GetUserGrantAsync(userId, grantId);

            // Assert
            grant.Should().NotBeNull();
            grant.Id.Should().Be(grantId);
            grant.Status.Should().Be(GrantOrTokenStatus.ACTIVE);
            grant.ClientId.Should().Be(clientId);
            grant.UserId.Should().Be(userId);
            grant.ScopeId.Should().Be(scopeId);
            grant.Source.Should().Be(OAuth2ScopeConsentGrantSource.ENDUSER);
            grant.Issuer.Should().Be("https://test.okta.com/oauth2/default");

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userId}/grants/{grantId}");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
            mockClient.ReceivedPathParams.Should().ContainKey("grantId");
            mockClient.ReceivedPathParams["grantId"].Should().Contain(grantId);
        }

        [Fact]
        public async Task GetUserGrant_WithExpandScope_IncludesExpandParameter()
        {
            // Arrange
            var userId = "user-expand-123";
            var grantId = "grant-expand-456";

            var responseJson = @"{
                ""id"": """ + grantId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-05T12:00:00.000Z"",
                ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                ""issuer"": ""https://test.okta.com/oauth2/default"",
                ""clientId"": ""client-789"",
                ""userId"": """ + userId + @""",
                ""scopeId"": ""openid"",
                ""source"": ""ADMIN"",
                ""createdBy"": {
                    ""id"": ""admin-123"",
                    ""type"": ""User""
                },
                ""_embedded"": {
                    ""scope"": {
                        ""id"": ""openid"",
                        ""name"": ""openid"",
                        ""description"": ""OpenID Connect scope""
                    }
                },
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"/grants/" + grantId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var grant = await userGrantApi.GetUserGrantAsync(userId, grantId, "scope");

            // Assert
            grant.Should().NotBeNull();
            grant.Source.Should().Be(OAuth2ScopeConsentGrantSource.ADMIN);

            mockClient.ReceivedQueryParams.Should().NotBeNull();
        }

        [Fact]
        public async Task GetUserGrant_CallsCorrectEndpoint()
        {
            // Arrange
            var userId = "user-endpoint-123";
            var grantId = "grant-endpoint-456";

            var responseJson = @"{
                ""id"": """ + grantId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-05T12:00:00.000Z"",
                ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                ""issuer"": ""https://test.okta.com/oauth2/default"",
                ""clientId"": ""client-789"",
                ""userId"": """ + userId + @""",
                ""scopeId"": ""openid"",
                ""source"": ""END_USER"",
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"/grants/" + grantId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await userGrantApi.GetUserGrantAsync(userId, grantId);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userId}/grants/{grantId}");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
            mockClient.ReceivedPathParams.Should().ContainKey("grantId");
            mockClient.ReceivedPathParams["grantId"].Should().Contain(grantId);
        }

        [Fact]
        public async Task GetUserGrant_WithHttpInfo_ReturnsCorrectResponse()
        {
            // Arrange
            var userId = "user-httpinfo-123";
            var grantId = "grant-httpinfo-456";

            var responseJson = @"{
                ""id"": """ + grantId + @""",
                ""status"": ""ACTIVE"",
                ""created"": ""2025-10-05T12:00:00.000Z"",
                ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                ""issuer"": ""https://test.okta.com/oauth2/default"",
                ""clientId"": ""client-789"",
                ""userId"": """ + userId + @""",
                ""scopeId"": ""openid"",
                ""source"": ""END_USER"",
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"/grants/" + grantId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var response = await userGrantApi.GetUserGrantWithHttpInfoAsync(userId, grantId);

            // Assert
            response.Should().NotBeNull();
            response.StatusCode.Should().Be(HttpStatusCode.OK);
            response.Data.Should().NotBeNull();
            response.Data.Id.Should().Be(grantId);
            response.Data.Status.Should().Be(GrantOrTokenStatus.ACTIVE);

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userId}/grants/{grantId}");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
            mockClient.ReceivedPathParams.Should().ContainKey("grantId");
            mockClient.ReceivedPathParams["grantId"].Should().Contain(grantId);
        }

        #endregion

        #region ListUserGrants Tests

        [Fact]
        public async Task ListUserGrants_ReturnsGrantList()
        {
            // Arrange
            var userId = "user-list-123";

            var responseJson = @"[
                {
                    ""id"": ""grant-1"",
                    ""status"": ""ACTIVE"",
                    ""created"": ""2025-10-05T12:00:00.000Z"",
                    ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                    ""issuer"": ""https://test.okta.com/oauth2/default"",
                    ""clientId"": ""client-1"",
                    ""userId"": """ + userId + @""",
                    ""scopeId"": ""openid"",
                    ""source"": ""END_USER"",
                    ""_links"": {
                        ""self"": {
                            ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"/grants/grant-1""
                        }
                    }
                },
                {
                    ""id"": ""grant-2"",
                    ""status"": ""ACTIVE"",
                    ""created"": ""2025-10-05T13:00:00.000Z"",
                    ""lastUpdated"": ""2025-10-05T13:00:00.000Z"",
                    ""issuer"": ""https://test.okta.com/oauth2/default"",
                    ""clientId"": ""client-2"",
                    ""userId"": """ + userId + @""",
                    ""scopeId"": ""profile"",
                    ""source"": ""ADMIN"",
                    ""_links"": {
                        ""self"": {
                            ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"/grants/grant-2""
                        }
                    }
                }
            ]";

            var mockClient = new MockAsyncClient(responseJson);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var grants = await userGrantApi.ListUserGrantsWithHttpInfoAsync(userId);

            // Assert
            grants.Should().NotBeNull();
            grants.Data.Should().HaveCount(2);
            grants.Data[0].Id.Should().Be("grant-1");
            grants.Data[0].ScopeId.Should().Be("openid");
            grants.Data[0].Source.Should().Be(OAuth2ScopeConsentGrantSource.ENDUSER);
            grants.Data[1].Id.Should().Be("grant-2");
            grants.Data[1].ScopeId.Should().Be("profile");
            grants.Data[1].Source.Should().Be(OAuth2ScopeConsentGrantSource.ADMIN);

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userId}/grants");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
        }

        [Fact]
        public async Task ListUserGrants_WithScopeFilter_IncludesScopeParameter()
        {
            // Arrange
            var userId = "user-scope-filter-123";
            var scopeId = "openid";

            var responseJson = @"[
                {
                    ""id"": ""grant-filtered"",
                    ""status"": ""ACTIVE"",
                    ""created"": ""2025-10-05T12:00:00.000Z"",
                    ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                    ""issuer"": ""https://test.okta.com/oauth2/default"",
                    ""clientId"": ""client-1"",
                    ""userId"": """ + userId + @""",
                    ""scopeId"": """ + scopeId + @""",
                    ""source"": ""END_USER"",
                    ""_links"": {
                        ""self"": {
                            ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"/grants/grant-filtered""
                        }
                    }
                }
            ]";

            var mockClient = new MockAsyncClient(responseJson);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var grants = await userGrantApi.ListUserGrantsWithHttpInfoAsync(userId, scopeId: scopeId);

            // Assert
            grants.Should().NotBeNull();
            grants.Data.Should().HaveCount(1);
            grants.Data[0].ScopeId.Should().Be(scopeId);

            mockClient.ReceivedQueryParams.Should().NotBeNull();
        }

        [Fact]
        public async Task ListUserGrants_WithPagination_IncludesPaginationParameters()
        {
            // Arrange
            var userId = "user-pagination-123";
            var limit = 10;
            var after = "cursor-123";

            var responseJson = @"[]";

            var mockClient = new MockAsyncClient(responseJson);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var grants = await userGrantApi.ListUserGrantsWithHttpInfoAsync(userId, limit: limit, after: after);

            // Assert
            grants.Should().NotBeNull();
            grants.Data.Should().BeEmpty();

            mockClient.ReceivedQueryParams.Should().NotBeNull();
        }

        [Fact]
        public async Task ListUserGrants_CallsCorrectEndpoint()
        {
            // Arrange
            var userId = "user-endpoint-123";
            var responseJson = @"[]";

            var mockClient = new MockAsyncClient(responseJson);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var grants = await userGrantApi.ListUserGrantsWithHttpInfoAsync(userId);

            // Assert
            grants.Should().NotBeNull();
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userId}/grants");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
        }

        #endregion

        #region ListGrantsForUserAndClient Tests

        [Fact]
        public async Task ListGrantsForUserAndClient_ReturnsClientGrantsList()
        {
            // Arrange
            var userId = "user-client-123";
            var clientId = "client-456";

            var responseJson = @"[
                {
                    ""id"": ""grant-client-1"",
                    ""status"": ""ACTIVE"",
                    ""created"": ""2025-10-05T12:00:00.000Z"",
                    ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                    ""issuer"": ""https://test.okta.com/oauth2/default"",
                    ""clientId"": """ + clientId + @""",
                    ""userId"": """ + userId + @""",
                    ""scopeId"": ""openid"",
                    ""source"": ""END_USER"",
                    ""_links"": {
                        ""self"": {
                            ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"/clients/" + clientId + @"/grants/grant-client-1""
                        }
                    }
                }
            ]";

            var mockClient = new MockAsyncClient(responseJson);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var grants = await userGrantApi.ListGrantsForUserAndClientWithHttpInfoAsync(userId, clientId);

            // Assert
            grants.Should().NotBeNull();
            grants.Data.Should().HaveCount(1);
            grants.Data[0].ClientId.Should().Be(clientId);
            grants.Data[0].UserId.Should().Be(userId);

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userId}/clients/{clientId}/grants");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
            mockClient.ReceivedPathParams.Should().ContainKey("clientId");
            mockClient.ReceivedPathParams["clientId"].Should().Contain(clientId);
        }

        [Fact]
        public async Task ListGrantsForUserAndClient_WithExpand_IncludesExpandParameter()
        {
            // Arrange
            var userId = "user-expand-123";
            var clientId = "client-expand-456";

            var responseJson = @"[
                {
                    ""id"": ""grant-expand-1"",
                    ""status"": ""ACTIVE"",
                    ""created"": ""2025-10-05T12:00:00.000Z"",
                    ""lastUpdated"": ""2025-10-05T12:00:00.000Z"",
                    ""issuer"": ""https://test.okta.com/oauth2/default"",
                    ""clientId"": """ + clientId + @""",
                    ""userId"": """ + userId + @""",
                    ""scopeId"": ""openid"",
                    ""source"": ""END_USER"",
                    ""_embedded"": {
                        ""scope"": {
                            ""id"": ""openid"",
                            ""name"": ""openid""
                        }
                    },
                    ""_links"": {
                        ""self"": {
                            ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"/clients/" + clientId + @"/grants/grant-expand-1""
                        }
                    }
                }
            ]";

            var mockClient = new MockAsyncClient(responseJson);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var grants = await userGrantApi.ListGrantsForUserAndClientWithHttpInfoAsync(userId, clientId, expand: "scope");

            // Assert
            grants.Should().NotBeNull();
            grants.Data.Should().HaveCount(1);

            mockClient.ReceivedQueryParams.Should().NotBeNull();
        }

        [Fact]
        public async Task ListGrantsForUserAndClient_CallsCorrectEndpoint()
        {
            // Arrange
            var userId = "user-endpoint-123";
            var clientId = "client-endpoint-456";
            var responseJson = @"[]";

            var mockClient = new MockAsyncClient(responseJson);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var grants = await userGrantApi.ListGrantsForUserAndClientWithHttpInfoAsync(userId, clientId);

            // Assert
            grants.Should().NotBeNull();
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userId}/clients/{clientId}/grants");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
            mockClient.ReceivedPathParams.Should().ContainKey("clientId");
            mockClient.ReceivedPathParams["clientId"].Should().Contain(clientId);
        }

        #endregion

        #region RevokeUserGrant Tests

        [Fact]
        public async Task RevokeUserGrant_CallsCorrectEndpoint()
        {
            // Arrange
            var userId = "user-revoke-123";
            var grantId = "grant-revoke-456";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await userGrantApi.RevokeUserGrantAsync(userId, grantId);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userId}/grants/{grantId}");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
            mockClient.ReceivedPathParams.Should().ContainKey("grantId");
            mockClient.ReceivedPathParams["grantId"].Should().Contain(grantId);
        }

        [Fact]
        public async Task RevokeUserGrant_WithHttpInfo_ReturnsCorrectResponse()
        {
            // Arrange
            var userId = "user-revoke-info-123";
            var grantId = "grant-revoke-info-456";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var response = await userGrantApi.RevokeUserGrantWithHttpInfoAsync(userId, grantId);

            // Assert
            response.Should().NotBeNull();
            response.StatusCode.Should().Be(HttpStatusCode.NoContent);

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userId}/grants/{grantId}");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
            mockClient.ReceivedPathParams.Should().ContainKey("grantId");
            mockClient.ReceivedPathParams["grantId"].Should().Contain(grantId);
        }

        #endregion

        #region RevokeUserGrants Tests

        [Fact]
        public async Task RevokeUserGrants_CallsCorrectEndpoint()
        {
            // Arrange
            var userId = "user-revoke-all-123";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await userGrantApi.RevokeUserGrantsAsync(userId);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userId}/grants");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
        }

        [Fact]
        public async Task RevokeUserGrants_WithHttpInfo_ReturnsCorrectResponse()
        {
            // Arrange
            var userId = "user-revoke-all-info-123";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var response = await userGrantApi.RevokeUserGrantsWithHttpInfoAsync(userId);

            // Assert
            response.Should().NotBeNull();
            response.StatusCode.Should().Be(HttpStatusCode.NoContent);

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userId}/grants");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
        }

        #endregion

        #region RevokeGrantsForUserAndClient Tests

        [Fact]
        public async Task RevokeGrantsForUserAndClient_CallsCorrectEndpoint()
        {
            // Arrange
            var userId = "user-revoke-client-123";
            var clientId = "client-revoke-456";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            await userGrantApi.RevokeGrantsForUserAndClientAsync(userId, clientId);

            // Assert
            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userId}/clients/{clientId}/grants");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
            mockClient.ReceivedPathParams.Should().ContainKey("clientId");
            mockClient.ReceivedPathParams["clientId"].Should().Contain(clientId);
        }

        [Fact]
        public async Task RevokeGrantsForUserAndClient_WithHttpInfo_ReturnsCorrectResponse()
        {
            // Arrange
            var userId = "user-revoke-client-info-123";
            var clientId = "client-revoke-info-456";

            var mockClient = new MockAsyncClient("", HttpStatusCode.NoContent);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var response = await userGrantApi.RevokeGrantsForUserAndClientWithHttpInfoAsync(userId, clientId);

            // Assert
            response.Should().NotBeNull();
            response.StatusCode.Should().Be(HttpStatusCode.NoContent);

            mockClient.ReceivedPath.Should().StartWith("/api/v1/users/{userId}/clients/{clientId}/grants");
            mockClient.ReceivedPathParams.Should().ContainKey("userId");
            mockClient.ReceivedPathParams["userId"].Should().Contain(userId);
            mockClient.ReceivedPathParams.Should().ContainKey("clientId");
            mockClient.ReceivedPathParams["clientId"].Should().Contain(clientId);
        }

        #endregion

        #region Additional Edge Case Tests

        [Fact]
        public async Task GetUserGrant_WithRevokedStatus_ReturnsRevokedGrant()
        {
            // Arrange
            var userId = "user-revoked-123";
            var grantId = "grant-revoked-456";

            var responseJson = @"{
                ""id"": """ + grantId + @""",
                ""status"": ""REVOKED"",
                ""created"": ""2025-10-05T12:00:00.000Z"",
                ""lastUpdated"": ""2025-10-06T12:00:00.000Z"",
                ""issuer"": ""https://test.okta.com/oauth2/default"",
                ""clientId"": ""client-789"",
                ""userId"": """ + userId + @""",
                ""scopeId"": ""openid"",
                ""source"": ""ADMIN"",
                ""_links"": {
                    ""self"": {
                        ""href"": ""https://test.okta.com/api/v1/users/" + userId + @"/grants/" + grantId + @"""
                    }
                }
            }";

            var mockClient = new MockAsyncClient(responseJson);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var grant = await userGrantApi.GetUserGrantAsync(userId, grantId);

            // Assert
            grant.Should().NotBeNull();
            grant.Status.Should().Be(GrantOrTokenStatus.REVOKED);
            grant.Source.Should().Be(OAuth2ScopeConsentGrantSource.ADMIN);
        }

        [Fact]
        public async Task ListUserGrants_EmptyResponse_ReturnsEmptyList()
        {
            // Arrange
            var userId = "user-empty-123";
            var responseJson = @"[]";

            var mockClient = new MockAsyncClient(responseJson);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var grants = await userGrantApi.ListUserGrantsWithHttpInfoAsync(userId);

            // Assert
            grants.Should().NotBeNull();
            grants.Data.Should().BeEmpty();
        }

        [Fact]
        public async Task ListGrantsForUserAndClient_EmptyResponse_ReturnsEmptyList()
        {
            // Arrange
            var userId = "user-empty-client-123";
            var clientId = "client-empty-456";
            var responseJson = @"[]";

            var mockClient = new MockAsyncClient(responseJson);
            var userGrantApi = new UserGrantApi(mockClient, new Configuration { BasePath = "https://test.okta.com" });

            // Act
            var grants = await userGrantApi.ListGrantsForUserAndClientWithHttpInfoAsync(userId, clientId);

            // Assert
            grants.Should().NotBeNull();
            grants.Data.Should().BeEmpty();
        }

        #endregion
    }
}
